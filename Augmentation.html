
<!-- saved from url=(0106)file:///C:/Users/Sadik%20Bhattarai/PycharmProjects/pythonProject5/exportToHTML/randomforestbagging.py.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>randomforestbagging.py</title>

<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #629755; font-style: italic;}
.s3 { color: #cc7832;}
.s4 { color: #a9b7c6;}
.s5 { color: #6a8759;}
.s6 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table cellspacing="0" cellpadding="5" cols="1" width="100%" bgcolor="#606060">
<tbody><tr><td><center>
<font face="Arial, Helvetica" color="#000000">
randomforestbagging.py</font>
</center></td></tr></tbody></table>
<pre><span class="s0"># -*- coding: utf-8 -*-</span>
<span class="s2">"""RandomForestBagging.ipynb 
 
Automatically generated by Colaboratory. 
 
Original file is located at 
    https://colab.research.google.com/drive/1lGj12gau-ruGtyXgQ1ZbpVFImiS_Vh52 
"""</span>

<span class="s0"># Commented out IPython magic to ensure Python compatibility.</span>
<span class="s0">#from Bio import SeqIO</span>
<span class="s3">import </span><span class="s1">numpy </span><span class="s3">as </span><span class="s1">np </span>
<span class="s3">from </span><span class="s1">sklearn.utils </span><span class="s3">import </span><span class="s1">shuffle</span>
<span class="s3">import </span><span class="s1">random</span>

<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">BaggingClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.linear_model </span><span class="s3">import </span><span class="s1">Perceptron</span>
<span class="s3">from </span><span class="s1">sklearn.metrics </span><span class="s3">import </span><span class="s1">ConfusionMatrixDisplay</span>

<span class="s3">from </span><span class="s1">sklearn </span><span class="s3">import </span><span class="s1">svm</span>
<span class="s3">from </span><span class="s1">sklearn.svm </span><span class="s3">import </span><span class="s1">LinearSVC</span>
<span class="s3">from </span><span class="s1">sklearn.svm </span><span class="s3">import </span><span class="s1">SVC</span>
<span class="s3">from </span><span class="s1">sklearn.svm </span><span class="s3">import </span><span class="s1">SVR</span>
<span class="s3">from </span><span class="s1">sklearn.metrics </span><span class="s3">import </span><span class="s1">matthews_corrcoef</span>
<span class="s0">#from sklearn.datasets import make_classification</span>
<span class="s0">#from sklearn.metrics import roc_curve</span>
<span class="s0">#from sklearn.metrics import roc_auc_score</span>
<span class="s0">#from matplotlib import pyplot</span>
<span class="s3">import </span><span class="s1">matplotlib.pyplot </span><span class="s3">as </span><span class="s1">plt</span>
<span class="s0"># %matplotlib inline</span>
<span class="s3">from </span><span class="s1">sklearn </span><span class="s3">import </span><span class="s1">metrics</span>
<span class="s0">#from sklearn.model_selection import cross_val_score</span>
<span class="s3">from </span><span class="s1">sklearn.metrics </span><span class="s3">import </span><span class="s1">accuracy_score</span>



<span class="s3">import </span><span class="s1">pickle</span>
<span class="s3">from </span><span class="s1">sklearn.neural_network </span><span class="s3">import </span><span class="s1">MLPClassifier</span>

<span class="s0">#from sklearn import metrics</span>
<span class="s0">#from sklearn.model_selection import cross_val_score</span>
<span class="s3">from </span><span class="s1">sklearn.metrics </span><span class="s3">import </span><span class="s1">confusion_matrix</span>
<span class="s3">import </span><span class="s1">pickle</span>
<span class="s3">from </span><span class="s1">sklearn.naive_bayes </span><span class="s3">import </span><span class="s1">GaussianNB</span>
<span class="s0">#from sklearn.neural_network import MLPClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.neighbors </span><span class="s3">import </span><span class="s1">KNeighborsClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.linear_model </span><span class="s3">import </span><span class="s1">SGDClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.gaussian_process </span><span class="s3">import </span><span class="s1">GaussianProcessClassifier</span>

<span class="s0">#from sklearn.gaussian_process import GaussianProcessClassifier</span>
<span class="s0">#from sklearn.gaussian_process.kernels import RBF</span>
<span class="s3">from </span><span class="s1">sklearn.tree </span><span class="s3">import </span><span class="s1">DecisionTreeClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">RandomForestClassifier</span><span class="s3">, </span><span class="s1">AdaBoostClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.naive_bayes </span><span class="s3">import </span><span class="s1">GaussianNB</span>
<span class="s0">#from sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis</span>


<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">ExtraTreesClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">GradientBoostingClassifier</span>

<span class="s0">#from itertools import product</span>
<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">VotingClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.linear_model </span><span class="s3">import </span><span class="s1">LogisticRegression</span>
<span class="s3">from </span><span class="s1">sklearn.model_selection </span><span class="s3">import </span><span class="s1">KFold</span>
<span class="s3">from </span><span class="s1">sklearn </span><span class="s3">import </span><span class="s1">preprocessing</span>
<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">RandomForestClassifier</span><span class="s3">, </span><span class="s1">StackingClassifier</span>

<span class="s3">from </span><span class="s1">sklearn.feature_selection </span><span class="s3">import </span><span class="s1">RFE</span>
<span class="s3">from </span><span class="s1">sklearn.feature_selection </span><span class="s3">import </span><span class="s1">RFECV</span>


<span class="s0">#from mlxtend.classifier import StackingCVClassifier</span>

<span class="s3">from </span><span class="s1">sklearn.model_selection </span><span class="s3">import </span><span class="s1">RandomizedSearchCV</span>

<span class="s3">from </span><span class="s1">sklearn.model_selection </span><span class="s3">import </span><span class="s1">GridSearchCV</span>

<span class="s4">!</span><span class="s1">pip install scikit-plot</span>

<span class="s3">import </span><span class="s1">scikitplot </span><span class="s3">as </span><span class="s1">skplt</span>

<span class="s0">#AMINO ACID COMPOSITION FOR ACP PREDICTION - 20 DIMENSIONAL FEATURE VECTOR</span>
<span class="s3">import </span><span class="s1">numpy </span><span class="s3">as </span><span class="s1">np</span>
<span class="s3">import </span><span class="s1">pandas </span><span class="s3">as </span><span class="s1">pd</span>
<span class="s3">import </span><span class="s1">matplotlib.pyplot </span><span class="s3">as </span><span class="s1">plt</span>
<span class="s3">import </span><span class="s1">seaborn </span><span class="s3">as </span><span class="s1">sns</span>
<span class="s3">from </span><span class="s1">pandas.core.common </span><span class="s3">import </span><span class="s1">random_state</span>

<span class="s3">def </span><span class="s1">AAC_740():</span>
    <span class="s1">df = pd.read_csv(</span><span class="s5">"/content/Acp740AACEncoding.csv"</span><span class="s3">,</span><span class="s1">header=</span><span class="s3">None</span><span class="s1">)</span>
    <span class="s1">df.columns=[</span><span class="s5">'label'</span><span class="s3">,</span><span class="s5">'AAC_A'</span><span class="s3">,</span><span class="s5">'AAC_C'</span><span class="s3">,</span><span class="s5">'AAC_D'</span><span class="s3">,</span><span class="s5">'AAC_E'</span><span class="s3">,</span><span class="s5">'AAC_F'</span><span class="s3">,</span><span class="s5">'AAC_G'</span><span class="s3">,</span><span class="s5">'AAC_H'</span><span class="s3">,</span><span class="s5">'AAC_I'</span><span class="s3">,</span><span class="s5">'AAC_K'</span><span class="s3">,</span><span class="s5">'AAC_L'</span><span class="s3">,</span><span class="s5">'AAC_M'</span><span class="s3">,</span><span class="s5">'AAC_N'</span><span class="s3">,</span><span class="s5">'AAC_P'</span><span class="s3">,</span><span class="s5">'AAC_Q'</span><span class="s3">,</span><span class="s5">'AAC_R'</span><span class="s3">,</span><span class="s5">'AAC_S'</span><span class="s3">,</span><span class="s5">'AAC_T'</span><span class="s3">,</span><span class="s5">'AAC_V'</span><span class="s3">,</span><span class="s5">'AAC_W'</span><span class="s3">,</span><span class="s5">'AAC_Y'</span><span class="s1">]</span>
    <span class="s1">data1 = df.drop(columns=</span><span class="s5">'label'</span><span class="s3">,</span><span class="s1">axis=</span><span class="s6">1</span><span class="s1">)</span>
    <span class="s1">X_aac = np.array(data1)</span>
    <span class="s1">label=df[</span><span class="s5">'label'</span><span class="s1">]</span>
    <span class="s3">return </span><span class="s1">np.array(X_aac)</span><span class="s3">,</span><span class="s1">label</span>

<span class="s3">def </span><span class="s1">AAC_240():</span>
    <span class="s1">df = pd.read_csv(</span><span class="s5">"/content/Acp240AACEncoding.csv"</span><span class="s3">,</span><span class="s1">header=</span><span class="s3">None</span><span class="s1">)</span>
    <span class="s1">df.columns=[</span><span class="s5">'label'</span><span class="s3">,</span><span class="s5">'AAC_A'</span><span class="s3">,</span><span class="s5">'AAC_C'</span><span class="s3">,</span><span class="s5">'AAC_D'</span><span class="s3">,</span><span class="s5">'AAC_E'</span><span class="s3">,</span><span class="s5">'AAC_F'</span><span class="s3">,</span><span class="s5">'AAC_G'</span><span class="s3">,</span><span class="s5">'AAC_H'</span><span class="s3">,</span><span class="s5">'AAC_I'</span><span class="s3">,</span><span class="s5">'AAC_K'</span><span class="s3">,</span><span class="s5">'AAC_L'</span><span class="s3">,</span><span class="s5">'AAC_M'</span><span class="s3">,</span><span class="s5">'AAC_N'</span><span class="s3">,</span><span class="s5">'AAC_P'</span><span class="s3">,</span><span class="s5">'AAC_Q'</span><span class="s3">,</span><span class="s5">'AAC_R'</span><span class="s3">,</span><span class="s5">'AAC_S'</span><span class="s3">,</span><span class="s5">'AAC_T'</span><span class="s3">,</span><span class="s5">'AAC_V'</span><span class="s3">,</span><span class="s5">'AAC_W'</span><span class="s3">,</span><span class="s5">'AAC_Y'</span><span class="s1">]</span>
    <span class="s1">data2 = df.drop(columns=</span><span class="s5">'label'</span><span class="s3">,</span><span class="s1">axis=</span><span class="s6">1</span><span class="s1">)</span>
    <span class="s1">X_aac = np.array(data2)</span>
    <span class="s1">label=df[</span><span class="s5">'label'</span><span class="s1">]</span>
    <span class="s3">return </span><span class="s1">np.array(X_aac)</span><span class="s3">,</span><span class="s1">label</span>

<span class="s3">def </span><span class="s1">prepare_feature_acp740():</span>
    <span class="s1">label = []</span>
    <span class="s1">protein_seq_dict = {}</span>
    <span class="s1">protein_index = </span><span class="s6">0</span>
    <span class="s3">with </span><span class="s1">open(</span><span class="s5">'acp740.txt'</span><span class="s3">, </span><span class="s5">'r'</span><span class="s1">) </span><span class="s3">as </span><span class="s1">fp:</span>
        <span class="s3">for </span><span class="s1">line </span><span class="s3">in </span><span class="s1">fp:</span>
            <span class="s3">if </span><span class="s1">line[</span><span class="s6">0</span><span class="s1">] == </span><span class="s5">'&gt;'</span><span class="s1">:</span>
                <span class="s1">values = line[</span><span class="s6">1</span><span class="s1">:].strip().split(</span><span class="s5">'|'</span><span class="s1">)</span>
                <span class="s1">label_temp = values[</span><span class="s6">1</span><span class="s1">]</span>
<span class="s0">#                proteinName = values[0]</span>
                <span class="s3">if </span><span class="s1">label_temp == </span><span class="s5">'1'</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s6">1</span><span class="s1">)</span>
                <span class="s3">else</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s6">0</span><span class="s1">)</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">seq = line[:-</span><span class="s6">1</span><span class="s1">]</span>
                <span class="s1">protein_seq_dict[protein_index] = seq</span>
                <span class="s1">protein_index = protein_index + </span><span class="s6">1</span>
    <span class="s1">bpf=[]</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">protein_seq_dict:  </span><span class="s0"># and protein_fea_dict.has_key(protein) and RNA_fea_dict.has_key(RNA):</span>
        <span class="s1">bpf_feature = BPF(protein_seq_dict[i])</span>
        <span class="s1">bpf.append(bpf_feature)</span>
    <span class="s3">return </span><span class="s1">np.array(bpf)</span><span class="s3">, </span><span class="s1">label</span>

<span class="s3">def </span><span class="s1">prepare_feature_acp240():</span>
    <span class="s1">label = []</span>
    <span class="s1">protein_seq_dict = {}</span>
    <span class="s1">protein_index = </span><span class="s6">1</span>
    <span class="s3">with </span><span class="s1">open(</span><span class="s5">'acp240.txt'</span><span class="s3">, </span><span class="s5">'r'</span><span class="s1">) </span><span class="s3">as </span><span class="s1">fp:</span>
        <span class="s3">for </span><span class="s1">line </span><span class="s3">in </span><span class="s1">fp:</span>
            <span class="s3">if </span><span class="s1">line[</span><span class="s6">0</span><span class="s1">] == </span><span class="s5">'&gt;'</span><span class="s1">:</span>
                <span class="s1">values = line[</span><span class="s6">1</span><span class="s1">:].strip().split(</span><span class="s5">'|'</span><span class="s1">)</span>
                <span class="s1">label_temp = values[</span><span class="s6">1</span><span class="s1">]</span>
<span class="s0">#                protein = values[0]</span>
                <span class="s3">if </span><span class="s1">label_temp==</span><span class="s5">'1'</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s6">1</span><span class="s1">)</span>
                <span class="s3">else</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s6">0</span><span class="s1">)</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">seq = line[:-</span><span class="s6">1</span><span class="s1">]</span>
                <span class="s1">protein_seq_dict[protein_index] = seq</span>
                <span class="s1">protein_index = protein_index + </span><span class="s6">1</span>
    <span class="s1">bpf = []</span>
    <span class="s0"># get protein feature</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">protein_seq_dict:  </span><span class="s0"># and protein_fea_dict.has_key(protein) and RNA_fea_dict.has_key(RNA):</span>

        <span class="s1">bpf_feature = BPF(protein_seq_dict[i])</span>
        <span class="s1">bpf.append(bpf_feature)</span>
        <span class="s1">protein_index = protein_index + </span><span class="s6">1</span>

    <span class="s3">return </span><span class="s1">np.array(bpf)</span><span class="s3">, </span><span class="s1">label</span>

<span class="s3">def </span><span class="s1">BPF(seq_temp):</span>
    <span class="s1">seq = seq_temp</span>
<span class="s0">#    chars = ['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y']</span>
    <span class="s1">fea = []</span>
    <span class="s1">tem_vec =[]</span>
    <span class="s1">k = </span><span class="s6">10</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">range(k):</span>
        <span class="s3">if </span><span class="s1">seq[i] ==</span><span class="s5">'A'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'C'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'D'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'E'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'F'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'G'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'H'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'I'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'K'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'L'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'M'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'N'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'P'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'Q'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'R'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'S'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'T'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'V'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'W'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s3">,</span><span class="s6">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s5">'Y'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">0</span><span class="s3">,</span><span class="s6">1</span><span class="s1">]</span>
        <span class="s1">fea = fea + tem_vec</span>
    <span class="s3">return </span><span class="s1">fea</span>

<span class="s3">def </span><span class="s1">calculate_performace(test_num</span><span class="s3">, </span><span class="s1">pred_y</span><span class="s3">, </span><span class="s1">labels):</span>
    <span class="s1">tp = </span><span class="s6">0</span>
    <span class="s1">fp = </span><span class="s6">0</span>
    <span class="s1">tn = </span><span class="s6">0</span>
    <span class="s1">fn = </span><span class="s6">0</span>
    <span class="s3">for </span><span class="s1">index </span><span class="s3">in </span><span class="s1">range(test_num):</span>
        <span class="s3">if </span><span class="s1">labels[index] == </span><span class="s6">1</span><span class="s1">:</span>
            <span class="s3">if </span><span class="s1">labels[index] == pred_y[index]:</span>
                <span class="s1">tp = tp + </span><span class="s6">1</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">fn = fn + </span><span class="s6">1</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s3">if </span><span class="s1">labels[index] == pred_y[index]:</span>
                <span class="s1">tn = tn + </span><span class="s6">1</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">fp = fp + </span><span class="s6">1</span>

    <span class="s1">acc = float(tp + tn) / test_num</span>
    <span class="s1">precision = float(tp) / (tp + fp)</span>
    <span class="s1">sensitivity = float(tp) / (tp + fn)</span>
    <span class="s1">specificity = float(tn) / (tn + fp)</span>
    <span class="s1">MCC = float(tp * tn - fp * fn) / (np.sqrt((tp + fp) * (tp + fn) * (tn + fp) * (tn + fn)))</span>
    <span class="s3">return </span><span class="s1">acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC</span>

<span class="s0">#    plt.plot(fp,tp,linestyle='--', color='orange',label='RandomForestClassifier')</span>
<span class="s0">#    plt.plot(fp, tp, linestyle='--', color='blue')</span>
<span class="s0">#    plt.title('ROC curve')</span>
<span class="s0">#    plt.xlabel('False Positive Rate')</span>
<span class="s0">#    plt.ylabel('True Positive rate')</span>
<span class="s0">#    plt.legend(loc='best')</span>
<span class="s0">#    plt.savefig('ROC_RFC',dpi=300)</span>
<span class="s0">#    plt.show();    </span>

<span class="s3">def </span><span class="s1">oversamp_pos(X_result</span><span class="s3">, </span><span class="s1">p):</span>
    <span class="s1">add_num = int(len(X_result)*p)</span>
<span class="s0">#    print(add_num)</span>
<span class="s0">#if(1):</span>
    <span class="s1">X_add_all = []</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">range(add_num):</span>
        <span class="s1">idx_ram = random.randint(</span><span class="s6">0</span><span class="s3">,</span><span class="s1">X_result.shape[</span><span class="s6">0</span><span class="s1">]-</span><span class="s6">1</span><span class="s1">)</span>
        <span class="s1">X_sel = X_result[idx_ram</span><span class="s3">,</span><span class="s1">:]</span>
        <span class="s1">value1 = np.zeros((</span><span class="s6">1</span><span class="s3">,</span><span class="s6">200</span><span class="s1">))</span>
        <span class="s1">value2 = np.random.uniform(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s1">(</span><span class="s6">1</span><span class="s3">, </span><span class="s1">fea_num - </span><span class="s6">220</span><span class="s1">))</span>
        <span class="s1">value3 = np.random.uniform(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s1">(</span><span class="s6">1</span><span class="s3">, </span><span class="s1">fea_num-</span><span class="s6">250</span><span class="s1">))        </span>
        <span class="s1">value = np.concatenate((value1</span><span class="s3">, </span><span class="s1">value2</span><span class="s3">,</span><span class="s1">value3)</span><span class="s3">,</span><span class="s1">axis = </span><span class="s6">1</span><span class="s1">)</span>
<span class="s0">#        value = np.random.normal(0,1,(1,483)) #正态分布</span>
<span class="s0">#        value = np.random.poisson(6, size=(1,483)) #泊松分布</span>
<span class="s0">#        value = np.random.exponential(10, size=(1,483)) #指数分布</span>
        <span class="s1">add_value = value*delta*X_sel</span>
<span class="s0">#        add_value[0,0] = 0 # ORFLen not be added</span>
        <span class="s1">X_add = X_sel + add_value</span>
        <span class="s1">X_add = np.squeeze(X_add)</span>
        <span class="s1">X_add_all.append(X_add)</span>
    <span class="s1">X_add_all = np.array(X_add_all)   </span>
<span class="s0">#    label_add = np.ones((add_num,),dtype = int)</span>
    <span class="s3">return </span><span class="s1">X_add_all</span><span class="s0">#,label_add</span>

<span class="s3">def </span><span class="s1">oversamp_neg(X_result</span><span class="s3">, </span><span class="s1">p):</span>
    <span class="s1">add_num = int(len(X_result)*p)</span>
<span class="s0">#    print(add_num)</span>

    <span class="s1">X_add_all = []</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">range(add_num):</span>
        <span class="s1">idx_ram = random.randint(</span><span class="s6">0</span><span class="s3">,</span><span class="s1">X_result.shape[</span><span class="s6">0</span><span class="s1">]-</span><span class="s6">1</span><span class="s1">)</span>
        <span class="s1">X_sel = X_result[idx_ram</span><span class="s3">,</span><span class="s1">:]</span>
        <span class="s1">value1 = np.zeros((</span><span class="s6">1</span><span class="s3">,</span><span class="s6">200</span><span class="s1">))</span>
        <span class="s1">value2 = np.random.uniform(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s1">(</span><span class="s6">1</span><span class="s3">, </span><span class="s1">fea_num - </span><span class="s6">220</span><span class="s1">)) </span><span class="s0">#均匀分布</span>
        <span class="s1">value3 = np.random.uniform(</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s1">(</span><span class="s6">1</span><span class="s3">, </span><span class="s1">fea_num-</span><span class="s6">250</span><span class="s1">))        </span>
        <span class="s1">value = np.concatenate((value1</span><span class="s3">, </span><span class="s1">value2</span><span class="s3">,</span><span class="s1">value3)</span><span class="s3">,</span><span class="s1">axis = </span><span class="s6">1</span><span class="s1">)</span>
<span class="s0">#        value = np.random.normal(0,1,(1,483)) #正态分布</span>
<span class="s0">#        value = np.random.poisson(6, size=(1,483)) #泊松分布</span>
<span class="s0">#        value = np.random.exponential(10, size=(1,483)) #指数分布</span>
        <span class="s1">add_value = value*delta*X_sel</span>
<span class="s0">#        add_value[0,0] = 0 # ORFLen not be added</span>
        <span class="s1">X_add = X_sel + add_value</span>
        <span class="s1">X_add = np.squeeze(X_add)</span>
        <span class="s1">X_add_all.append(X_add)</span>
    <span class="s1">X_add_all = np.array(X_add_all)   </span>
<span class="s0">#    label_add = np.zeros((add_num,),dtype = int) </span>
    <span class="s3">return </span><span class="s1">X_add_all</span><span class="s0">#,label_add</span>

<span class="s3">def </span><span class="s1">ACP_RF():</span>
    <span class="s0"># define parameters</span>
    <span class="s1">np.random.seed(</span><span class="s6">0</span><span class="s1">)</span>
    <span class="s1">random.seed(</span><span class="s6">0</span><span class="s1">)</span>
    <span class="s0"># x_train, x_test, y_train, y_test = train_test_split(X, label, test_size=0.1, random_state=1024)</span>
    <span class="s1">num_cross_val = </span><span class="s6">5  </span><span class="s0"># 5-fold</span>
    <span class="s1">all_performance_lstm = []</span>
    <span class="s1">all_prob = {}</span>
    <span class="s1">all_prob[</span><span class="s6">0</span><span class="s1">] = []</span>

    <span class="s3">for </span><span class="s1">fold </span><span class="s3">in </span><span class="s1">range(num_cross_val):</span>
        <span class="s0"># train = np.array([x for i, x in enumerate(bpf_fea) if i % num_cross_val != fold])</span>
        <span class="s0"># test = np.array([x for i, x in enumerate(bpf_fea) if i % num_cross_val == fold])</span>
        <span class="s0"># train = np.array([x for i, x in enumerate(kmer_fea) if i % num_cross_val != fold])</span>
        <span class="s0"># test = np.array([x for i, x in enumerate(kmer_fea) if i % num_cross_val == fold])</span>
        <span class="s1">train = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(X) </span><span class="s3">if </span><span class="s1">i % num_cross_val != fold])</span>
        <span class="s1">test = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(X) </span><span class="s3">if </span><span class="s1">i % num_cross_val == fold])</span>
        <span class="s1">train_label = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(label) </span><span class="s3">if </span><span class="s1">i % num_cross_val != fold])</span>
        <span class="s1">test_label = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(label) </span><span class="s3">if </span><span class="s1">i % num_cross_val == fold])</span>
        <span class="s1">real_labels = []</span>
        <span class="s3">for </span><span class="s1">val </span><span class="s3">in </span><span class="s1">test_label:</span>
            <span class="s3">if </span><span class="s1">val == </span><span class="s6">1</span><span class="s1">:</span>
                <span class="s1">real_labels.append(</span><span class="s6">1</span><span class="s1">)</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">real_labels.append(</span><span class="s6">0</span><span class="s1">)</span>

        <span class="s0"># augment the train data</span>
        <span class="s1">idx_pos = (train_label == </span><span class="s6">1</span><span class="s1">)</span>
        <span class="s1">idx_neg = (train_label == </span><span class="s6">0</span><span class="s1">)</span>
        <span class="s1">X_pos = train[idx_pos</span><span class="s3">,</span><span class="s1">:]</span>
        <span class="s1">X_neg = train[idx_neg</span><span class="s3">,</span><span class="s1">:]</span>
        <span class="s1">X_pos_add = oversamp_pos(X_pos</span><span class="s3">, </span><span class="s1">augtimes)</span>
        <span class="s1">X_neg_add = oversamp_neg(X_neg</span><span class="s3">, </span><span class="s1">augtimes)</span>
        <span class="s1">X_pos_new = np.concatenate((X_pos</span><span class="s3">, </span><span class="s1">X_pos_add))</span>
        <span class="s1">X_neg_new = np.concatenate((X_neg</span><span class="s3">, </span><span class="s1">X_neg_add))</span>
        <span class="s1">label_pos = np.ones((X_pos_new.shape[</span><span class="s6">0</span><span class="s1">]</span><span class="s3">,</span><span class="s1">)</span><span class="s3">,</span><span class="s1">dtype = int) </span>
        <span class="s1">label_neg = np.zeros((X_neg_new.shape[</span><span class="s6">0</span><span class="s1">]</span><span class="s3">,</span><span class="s1">)</span><span class="s3">,</span><span class="s1">dtype = int) </span>
        
        <span class="s1">train_new = np.concatenate((X_pos_new</span><span class="s3">, </span><span class="s1">X_neg_new))</span>
        <span class="s1">train_label_new = np.concatenate((label_pos</span><span class="s3">, </span><span class="s1">label_neg))</span>


        <span class="s0"># ACP740  # ACP240</span>

<span class="s0">#RECURSIVE FEATURE SELECTION - OPTIMAL FEATURE --REDUCING COLLINER FEATURE USING RFE-RFE </span>

<span class="s0">#        sel1= RFE(RandomForestClassifier(n_estimators=150,random_state=121,n_jobs=-1),n_features_to_select=200)</span>
<span class="s0">#        sel1.fit(train_new,train_label_new)</span>
<span class="s0">#        print(sel1.get_support())</span>
<span class="s0">#        features =train_new(sel.get_support)</span>
<span class="s0">#        train_new_rfe = sel1.transform(train_new)</span>
<span class="s0">#        test_rfe = sel1.transform(test)</span>
<span class="s0">#        print(test_rfe)</span>

<span class="s0">#Recursive Feature Selection using RFECV</span>
<span class="s0">#        estimator = SVR(kernel='linear')</span>
<span class="s0">#        sel2 = RFECV(estimator, step=1, cv=5, min_features_to_select=100)</span>
<span class="s0">#        sel2.fit(train_new_rfe,train_label_new)</span>
<span class="s0">#        train_new_rfe1 = sel2.transform(train_new_rfe)</span>
<span class="s0">#        test_rfe1 = sel2.transform(test_rfe) </span>

<span class="s0">#       MODEL FOR PREDICTING USING BAGGING CLASSIFIER</span>

<span class="s0">#        svc = SVC(kernel='linear')</span>
<span class="s0">#        rf =  RandomForestClassifier(random_state=0, n_estimators=100)  </span>
<span class="s0">#        clf = BaggingClassifier(base_estimator=RandomForestClassifier(random_state=121,n_estimators=295),n_estimators=120,random_state=120, bootstrap=True)</span>
<span class="s0">#        clf = BaggingClassifier(base_estimator=DecisionTreeClassifier(),n_estimators=150,bootstrap=True)</span>
<span class="s0">#        clf = BaggingClassifier(base_estimator=ExtraTreesClassifier(random_state=120,n_estimators=300,max_depth=32,min_samples_split=10,min_samples_leaf=1,max_features='auto',bootstrap=False),</span>
<span class="s0">#                                n_estimators =150,bootstrap=True,random_state=120)</span>
<span class="s0">#        clf = BaggingClassifier(base_estimator=KNeighborsClassifier(n_neighbors =3))</span>
<span class="s0">#        clf = BaggingClassifier(base_estimator=LogisticRegression(solver='liblinear'))</span>
<span class="s0">#        model = clf.fit(train_new, train_label_new)</span>
<span class="s0">#        y_pred_xgb = model.predict(test)</span>


<span class="s0">#      MODEL FOR PREDITCTING USING A VOTING CLASSIFIER</span>
<span class="s0">#        clf9 = DecisionTreeClassifier(random_state=0)</span>
<span class="s0">#        clf0 = LogisticRegression(solver='liblinear')</span>
<span class="s0">#        clf1 = ExtraTreesClassifier(random_state=0,n_estimators=400)</span>
<span class="s0">#        clf2 = AdaBoostClassifier(random_state=0)</span>
<span class="s0">#        clf3 = RandomForestClassifier(random_state=0,n_estimators=190)</span>
<span class="s0">#        clf4 = svm.SVC(kernel="linear") </span>
<span class="s0">#        clf5 = DecisionTreeClassifier(random_state=0)</span>
<span class="s0">#        clf6 = KNeighborsClassifier(n_neighbors =9)</span>
<span class="s0">#        clf7 = GaussianNB()</span>
<span class="s0">#        clf = VotingClassifier(estimators=[('LR',clf0),('ET',clf1),('RF',clf3),('KN',clf6),('DT',clf5),('GNB',clf7)],voting='soft')</span>
<span class="s0">#        model = clf.fit(train_new, train_label_new)</span>
<span class="s0">#        y_pred_xgb = model.predict(test)</span>


<span class="s0">#RandomSearchCV for Hyperparameter Tuning</span>

<span class="s0">#      n_estimators = [100,200,300,500,1000,1500]  #Number of trees in random Forest</span>
<span class="s0">#        max_features = ['auto','sqrt']  #Number of features in consideration for every split</span>
<span class="s0">#        min_samples_split = [10,20,30] # Minimum samples to split a node</span>
<span class="s0">#        min_samples_leaf = [1,5,7,10]</span>
<span class="s0">#        bootstrap = [True,False] #Method used to sample datapoints</span>

<span class="s0">#        random_grid = {'n_estimators': n_estimators,</span>
<span class="s0">#                       'max_features': max_features,</span>
<span class="s0">#                       'min_samples_split': min_samples_split,</span>
<span class="s0">#                       'min_samples_leaf':min_samples_leaf,</span>
<span class="s0">#                       'bootstrap':bootstrap}</span>

<span class="s0">#        clf = RandomForestClassifier()</span>

<span class="s0">#       clf_random = RandomizedSearchCV(estimator=clf,param_distributions= random_grid,n_iter=100, cv=5,verbose=2, random_state=120,n_jobs=-1)</span>
<span class="s0">#        clf_random.fit(train_new, train_label_new)</span>
<span class="s0">#        y_pred_xgb = clf_random.predict(test)</span>

<span class="s0">#        print ('Random grid: ', random_grid, '\n')</span>
<span class="s0"># print the best parameters</span>
<span class="s0">#        print ('Best Parameters: ', clf_random.best_params_, ' \n')</span>


<span class="s0">#HyperParameter tuning for ExtraTree Classifier</span>
<span class="s0">#        param_grid = {</span>
<span class="s0">#                        'n_estimators': [100,300,500,1000],</span>
<span class="s0">#                        'criterion': ['gini', 'entropy'],</span>
<span class="s0">#                        'max_depth': [2,8,16,32,50],</span>
<span class="s0">#                         #'oob_score': [True, False],</span>
<span class="s0">#                        'max_features': ['auto','sqrt','log2'],    </span>
<span class="s0">#                        'bootstrap': [True, False],</span>
<span class="s0">#                        'warm_start': [True, False],</span>
<span class="s0">#                    }</span>
<span class="s0">#        et = ExtraTreesClassifier()</span>
<span class="s0">#        clf = GridSearchCV(et,param_grid)</span>
<span class="s0">#        model = clf.fit(train_new, train_label_new)</span>
<span class="s0">#        print('Best Parameters:',model.best_estimator_,'\n')</span>


        


<span class="s0">#ACP740/ACP240 - PREDICITION USING SIMPLE ML</span>


        <span class="s1">mlp = MLPClassifier(hidden_layer_sizes = (</span><span class="s6">100</span><span class="s3">,</span><span class="s6">100</span><span class="s3">,</span><span class="s6">100</span><span class="s3">,</span><span class="s6">100</span><span class="s3">,</span><span class="s6">100</span><span class="s3">,</span><span class="s6">100</span><span class="s1">)</span><span class="s3">,</span><span class="s1">max_iter= </span><span class="s6">500</span><span class="s1">)</span>
        <span class="s1">parameter_space = {</span>
                            <span class="s5">'activation'</span><span class="s1">: [</span><span class="s5">'tanh'</span><span class="s3">, </span><span class="s5">'relu'</span><span class="s1">]</span><span class="s3">,</span>
                            <span class="s5">'solver'</span><span class="s1">: [</span><span class="s5">'sgd'</span><span class="s3">, </span><span class="s5">'adam'</span><span class="s1">]</span><span class="s3">,</span>
                            <span class="s5">'alpha'</span><span class="s1">: [</span><span class="s6">0.0001</span><span class="s3">, </span><span class="s6">0.05</span><span class="s1">]</span><span class="s3">,</span>
                            <span class="s5">'learning_rate'</span><span class="s1">: [</span><span class="s5">'constant'</span><span class="s3">,</span><span class="s5">'adaptive'</span><span class="s1">]</span><span class="s3">,</span>
<span class="s1">}</span>

        <span class="s1">clf = GridSearchCV(mlp</span><span class="s3">,</span><span class="s1">parameter_space</span><span class="s3">, </span><span class="s1">n_jobs=-</span><span class="s6">1</span><span class="s3">, </span><span class="s1">cv = </span><span class="s6">5</span><span class="s1">)</span>
<span class="s0">#        clf = MLPClassifier(hidden_layer_sizes=(100,100,100,100,100,100),alpha = 0.1,activation = 'tanh', random_state=120,max_iter=900,solver='adam')</span>
<span class="s0">#        clf = RandomForestClassifier(random_state=120,n_estimators=300,min_samples_split=10,min_samples_leaf=1,max_features='auto',bootstrap=False)   </span>
<span class="s0">#        clf = ExtraTreesClassifier(random_state=120,n_estimators=400,max_depth=32,min_samples_split=10,min_samples_leaf=1,max_features='auto',bootstrap=False)</span>
<span class="s0">#        clf = DecisionTreeClassifier(random_state=120)        </span>
<span class="s0">#        clf = svm.SVC(kernel='linear')</span>
<span class="s0">#        clf = LogisticRegression(max_iter = 1500,n_jobs=-1,random_state=0)</span>
<span class="s0">#        clf = KNeighborsClassifier(n_neighbors =3)</span>
<span class="s0">#        clf = GaussianNB() </span>


<span class="s0">#Boosting Algorithms for prediction</span>


<span class="s0">#        clf = AdaBoostClassifier(base_estimator=RandomForestClassifier(random_state=120,n_estimators=300,min_samples_split=10,min_samples_leaf=1,max_features='auto',bootstrap=False),random_state = 121,n_estimators=406,learning_rate=0.04)</span>
<span class="s0">#        clf = GradientBoostingClassifier(random_state=121,n_estimators=350,learning_rate=0.1,loss='deviance')</span>

        <span class="s1">model = clf.fit(train_new</span><span class="s3">, </span><span class="s1">train_label_new)</span>
        <span class="s1">y_pred_xgb = model.predict(test)</span>


<span class="s0">#Best Result of MultiLayer Perceptron</span>
<span class="s0">#        print('Best Parameter found \n',clf.best_params_)        </span>
<span class="s0">#        print(test_label)</span>
<span class="s0">#        print(y_pred_xgb)</span>

<span class="s0">#Predict Probabilities        </span>
        <span class="s1">pred_prob1 = model.predict_proba(test)</span>

        <span class="s1">acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC = calculate_performace(len(real_labels)</span><span class="s3">, </span><span class="s1">y_pred_xgb</span><span class="s3">, </span><span class="s1">real_labels)</span>
        <span class="s1">print(acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC)</span>
        <span class="s1">all_performance_lstm.append([acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC])</span>
<span class="s0">#        skplt.metrics.plot_roc_curve(test_label,pred_prob1, title="ACP ROC Curve", figsize=(12,6));</span>
        <span class="s1">print(</span><span class="s5">'Best Parameter found </span><span class="s3">\n</span><span class="s5">'</span><span class="s3">,</span><span class="s1">clf.best_params_)</span>
        
    <span class="s1">print(</span><span class="s5">'mean performance of ACP_RF'</span><span class="s1">)</span>
<span class="s0">#    print(np.mean(np.array(all_performance_lstm), axis=0))</span>
    <span class="s1">print(np.mean(np.array(all_performance_lstm)</span><span class="s3">, </span><span class="s1">axis=</span><span class="s6">0</span><span class="s1">))</span>
    <span class="s1">skplt.metrics.plot_roc_curve(test_label</span><span class="s3">,</span><span class="s1">pred_prob1</span><span class="s3">, </span><span class="s1">title=</span><span class="s5">"ACP ROC Curve"</span><span class="s3">, </span><span class="s1">figsize=(</span><span class="s6">9</span><span class="s3">,</span><span class="s6">6</span><span class="s1">));</span>


    

<span class="s0">#Confusion Matrix for Visulization of Classification using Different Models</span>
    <span class="s1">ConfusionMatrixDisplay.from_predictions(test_label</span><span class="s3">,</span><span class="s1">y_pred_xgb)</span>
    <span class="s1">plt.show</span>
    <span class="s1">plt.savefig(</span><span class="s5">"Confusion_Matrix_RF"</span><span class="s1">)</span>


<span class="s1">dataset = </span><span class="s6">1</span><span class="s0">#1.acp740   2.acp240</span>
<span class="s1">peptidelen = </span><span class="s6">50 </span><span class="s0">#50  #60</span>

<span class="s3">if </span><span class="s1">dataset == </span><span class="s6">1</span><span class="s1">:</span>
    <span class="s1">delta = </span><span class="s6">0.02  </span><span class="s0">#acp740</span>
    <span class="s1">augtimes = </span><span class="s6">3</span>
    <span class="s1">bpf</span><span class="s3">, </span><span class="s1">label = prepare_feature_acp740()</span>
    <span class="s1">X_aac</span><span class="s3">, </span><span class="s1">label = AAC_740()</span>
    <span class="s3">if </span><span class="s1">peptidelen == </span><span class="s6">40</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s5">'data740_40_50.pkl'</span><span class="s3">, </span><span class="s5">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s6">50</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s5">'data740_50_50.pkl'</span><span class="s3">, </span><span class="s5">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s6">60</span><span class="s1">:      </span>
        <span class="s1">data = pickle.load(open(</span><span class="s5">'data740_60_50.pkl'</span><span class="s3">, </span><span class="s5">'rb'</span><span class="s1">))</span>
<span class="s3">else</span><span class="s1">:</span>
    <span class="s1">delta = </span><span class="s6">0.005  </span><span class="s0">#acp240</span>
    <span class="s1">augtimes = </span><span class="s6">1</span>
    <span class="s1">bpf</span><span class="s3">, </span><span class="s1">label = prepare_feature_acp240()</span>
    <span class="s1">X_aac</span><span class="s3">, </span><span class="s1">label = AAC_240()</span>
    <span class="s3">if </span><span class="s1">peptidelen == </span><span class="s6">40</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s5">'data240_40_50.pkl'</span><span class="s3">, </span><span class="s5">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s6">50</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s5">'data240_50_50.pkl'</span><span class="s3">, </span><span class="s5">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s6">60</span><span class="s1">:      </span>
        <span class="s1">data = pickle.load(open(</span><span class="s5">'data240_60_50.pkl'</span><span class="s3">, </span><span class="s5">'rb'</span><span class="s1">))    </span>

<span class="s1">X_aa = data[</span><span class="s5">'X'</span><span class="s1">]</span>
<span class="s1">X_aa = np.array(X_aa)</span>
<span class="s1">X = np.concatenate((bpf</span><span class="s3">, </span><span class="s1">X_aa</span><span class="s3">,</span><span class="s1">X_aac)</span><span class="s3">, </span><span class="s1">axis=</span><span class="s6">1</span><span class="s1">)     </span>
<span class="s1">fea_num = X.shape[</span><span class="s6">1</span><span class="s1">]</span>
<span class="s1">ACP_RF()</span></pre>

</body></html>