
<!-- saved from url=(0106)file:///C:/Users/Sadik%20Bhattarai/PycharmProjects/pythonProject5/exportToHTML/nodataaugumentation.py.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>nodataaugumentation.py</title>

<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #629755; font-style: italic;}
.s3 { color: #cc7832;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table cellspacing="0" cellpadding="5" cols="1" width="100%" bgcolor="#606060">
<tbody><tr><td><center>
<font face="Arial, Helvetica" color="#000000">
nodataaugumentation.py</font>
</center></td></tr></tbody></table>
<pre><span class="s0"># -*- coding: utf-8 -*-</span>
<span class="s2">"""NoDataAugumentation.ipynb 
 
Automatically generated by Colaboratory. 
 
Original file is located at 
    https://colab.research.google.com/drive/1MQGElBL4XYtQY4AyVOn_TT6mUWL6dnHk 
"""</span>

<span class="s0">#from Bio import SeqIO</span>
<span class="s3">import </span><span class="s1">numpy </span><span class="s3">as </span><span class="s1">np </span>
<span class="s3">from </span><span class="s1">sklearn.utils </span><span class="s3">import </span><span class="s1">shuffle</span>
<span class="s3">import </span><span class="s1">random</span>

<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">BaggingClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.linear_model </span><span class="s3">import </span><span class="s1">Perceptron</span>
<span class="s3">from </span><span class="s1">sklearn.metrics </span><span class="s3">import </span><span class="s1">ConfusionMatrixDisplay</span>

<span class="s3">from </span><span class="s1">sklearn </span><span class="s3">import </span><span class="s1">svm</span>
<span class="s3">from </span><span class="s1">sklearn.svm </span><span class="s3">import </span><span class="s1">LinearSVC</span>
<span class="s3">from </span><span class="s1">sklearn.svm </span><span class="s3">import </span><span class="s1">SVC</span>
<span class="s3">from </span><span class="s1">sklearn.svm </span><span class="s3">import </span><span class="s1">SVR</span>
<span class="s3">from </span><span class="s1">sklearn.metrics </span><span class="s3">import </span><span class="s1">matthews_corrcoef</span>
<span class="s0">#from sklearn.datasets import make_classification</span>
<span class="s0">#from sklearn.metrics import roc_curve</span>
<span class="s0">#from sklearn.metrics import roc_auc_score</span>
<span class="s3">from </span><span class="s1">matplotlib </span><span class="s3">import </span><span class="s1">pyplot</span>
<span class="s3">import </span><span class="s1">matplotlib.pyplot </span><span class="s3">as </span><span class="s1">plt</span>
<span class="s3">from </span><span class="s1">sklearn </span><span class="s3">import </span><span class="s1">metrics</span>
<span class="s0">#from sklearn.model_selection import cross_val_score</span>

<span class="s3">import </span><span class="s1">pickle</span>
<span class="s3">from </span><span class="s1">sklearn.neural_network </span><span class="s3">import </span><span class="s1">MLPClassifier</span>

<span class="s0">#from sklearn import metrics</span>
<span class="s0">#from sklearn.model_selection import cross_val_score</span>
<span class="s3">from </span><span class="s1">sklearn.metrics </span><span class="s3">import </span><span class="s1">confusion_matrix</span>
<span class="s3">import </span><span class="s1">pickle</span>
<span class="s3">from </span><span class="s1">sklearn.naive_bayes </span><span class="s3">import </span><span class="s1">GaussianNB</span>
<span class="s0">#from sklearn.neural_network import MLPClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.neighbors </span><span class="s3">import </span><span class="s1">KNeighborsClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.linear_model </span><span class="s3">import </span><span class="s1">SGDClassifier</span>

<span class="s0">#from sklearn.gaussian_process import GaussianProcessClassifier</span>
<span class="s0">#from sklearn.gaussian_process.kernels import RBF</span>
<span class="s3">from </span><span class="s1">sklearn.tree </span><span class="s3">import </span><span class="s1">DecisionTreeClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">RandomForestClassifier</span><span class="s3">, </span><span class="s1">AdaBoostClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.naive_bayes </span><span class="s3">import </span><span class="s1">GaussianNB</span>
<span class="s0">#from sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis</span>


<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">ExtraTreesClassifier</span>
<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">GradientBoostingClassifier</span>

<span class="s0">#from itertools import product</span>
<span class="s0">#from sklearn.ensemble import VotingClassifier</span>
<span class="s0">#from sklearn.linear_model import LogisticRegression</span>
<span class="s3">from </span><span class="s1">sklearn.model_selection </span><span class="s3">import </span><span class="s1">KFold</span>
<span class="s3">from </span><span class="s1">sklearn </span><span class="s3">import </span><span class="s1">preprocessing</span>
<span class="s3">from </span><span class="s1">sklearn.ensemble </span><span class="s3">import </span><span class="s1">RandomForestClassifier</span><span class="s3">, </span><span class="s1">StackingClassifier</span>

<span class="s3">from </span><span class="s1">sklearn.feature_selection </span><span class="s3">import </span><span class="s1">RFE</span>
<span class="s3">from </span><span class="s1">sklearn.feature_selection </span><span class="s3">import </span><span class="s1">RFECV</span>

<span class="s3">import </span><span class="s1">pandas </span><span class="s3">as </span><span class="s1">pd</span>

<span class="s0">#from mlxtend.classifier import StackingCVClassifier</span>

<span class="s0">#feature Extraction -Amino acid compsition</span>
<span class="s0">#ACP740</span>
<span class="s3">def </span><span class="s1">AAC_740():</span>
    <span class="s1">df = pd.read_csv(</span><span class="s4">"/content/Acp740AACEncoding.csv"</span><span class="s3">,</span><span class="s1">header=</span><span class="s3">None</span><span class="s1">)</span>
    <span class="s1">df.columns=[</span><span class="s4">'label'</span><span class="s3">,</span><span class="s4">'AAC_A'</span><span class="s3">,</span><span class="s4">'AAC_C'</span><span class="s3">,</span><span class="s4">'AAC_D'</span><span class="s3">,</span><span class="s4">'AAC_E'</span><span class="s3">,</span><span class="s4">'AAC_F'</span><span class="s3">,</span><span class="s4">'AAC_G'</span><span class="s3">,</span><span class="s4">'AAC_H'</span><span class="s3">,</span><span class="s4">'AAC_I'</span><span class="s3">,</span><span class="s4">'AAC_K'</span><span class="s3">,</span><span class="s4">'AAC_L'</span><span class="s3">,</span><span class="s4">'AAC_M'</span><span class="s3">,</span><span class="s4">'AAC_N'</span><span class="s3">,</span><span class="s4">'AAC_P'</span><span class="s3">,</span><span class="s4">'AAC_Q'</span><span class="s3">,</span><span class="s4">'AAC_R'</span><span class="s3">,</span><span class="s4">'AAC_S'</span><span class="s3">,</span><span class="s4">'AAC_T'</span><span class="s3">,</span><span class="s4">'AAC_V'</span><span class="s3">,</span><span class="s4">'AAC_W'</span><span class="s3">,</span><span class="s4">'AAC_Y'</span><span class="s1">]</span>
    <span class="s1">data1 = df.drop(columns=</span><span class="s4">'label'</span><span class="s3">,</span><span class="s1">axis=</span><span class="s5">1</span><span class="s1">)</span>
    <span class="s1">X_aac = np.array(data1)</span>
    <span class="s1">label=df[</span><span class="s4">'label'</span><span class="s1">]</span>
    <span class="s3">return </span><span class="s1">np.array(X_aac)</span><span class="s3">,</span><span class="s1">label</span>

<span class="s0">#feature extraction - Amino acid composition</span>
<span class="s0">#ACP240</span>
<span class="s3">def </span><span class="s1">AAC_240():</span>
    <span class="s1">df = pd.read_csv(</span><span class="s4">"/content/Acp240AACEncoding.csv"</span><span class="s3">,</span><span class="s1">header=</span><span class="s3">None</span><span class="s1">)</span>
    <span class="s1">df.columns=[</span><span class="s4">'label'</span><span class="s3">,</span><span class="s4">'AAC_A'</span><span class="s3">,</span><span class="s4">'AAC_C'</span><span class="s3">,</span><span class="s4">'AAC_D'</span><span class="s3">,</span><span class="s4">'AAC_E'</span><span class="s3">,</span><span class="s4">'AAC_F'</span><span class="s3">,</span><span class="s4">'AAC_G'</span><span class="s3">,</span><span class="s4">'AAC_H'</span><span class="s3">,</span><span class="s4">'AAC_I'</span><span class="s3">,</span><span class="s4">'AAC_K'</span><span class="s3">,</span><span class="s4">'AAC_L'</span><span class="s3">,</span><span class="s4">'AAC_M'</span><span class="s3">,</span><span class="s4">'AAC_N'</span><span class="s3">,</span><span class="s4">'AAC_P'</span><span class="s3">,</span><span class="s4">'AAC_Q'</span><span class="s3">,</span><span class="s4">'AAC_R'</span><span class="s3">,</span><span class="s4">'AAC_S'</span><span class="s3">,</span><span class="s4">'AAC_T'</span><span class="s3">,</span><span class="s4">'AAC_V'</span><span class="s3">,</span><span class="s4">'AAC_W'</span><span class="s3">,</span><span class="s4">'AAC_Y'</span><span class="s1">]</span>
    <span class="s1">data2 = df.drop(columns=</span><span class="s4">'label'</span><span class="s3">,</span><span class="s1">axis=</span><span class="s5">1</span><span class="s1">)</span>
    <span class="s1">X_aac = np.array(data2)</span>
    <span class="s1">label=df[</span><span class="s4">'label'</span><span class="s1">]</span>
    <span class="s3">return </span><span class="s1">np.array(X_aac)</span><span class="s3">,</span><span class="s1">label</span>

<span class="s3">def </span><span class="s1">prepare_feature_acp740():</span>
    <span class="s1">label = []</span>
    <span class="s1">protein_seq_dict = {}</span>
    <span class="s1">protein_index = </span><span class="s5">0</span>
    <span class="s3">with </span><span class="s1">open(</span><span class="s4">'acp740.txt'</span><span class="s3">, </span><span class="s4">'r'</span><span class="s1">) </span><span class="s3">as </span><span class="s1">fp:</span>
        <span class="s3">for </span><span class="s1">line </span><span class="s3">in </span><span class="s1">fp:</span>
            <span class="s3">if </span><span class="s1">line[</span><span class="s5">0</span><span class="s1">] == </span><span class="s4">'&gt;'</span><span class="s1">:</span>
                <span class="s1">values = line[</span><span class="s5">1</span><span class="s1">:].strip().split(</span><span class="s4">'|'</span><span class="s1">)</span>
                <span class="s1">label_temp = values[</span><span class="s5">1</span><span class="s1">]</span>
<span class="s0">#                proteinName = values[0]</span>
                <span class="s3">if </span><span class="s1">label_temp == </span><span class="s4">'1'</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s5">1</span><span class="s1">)</span>
                <span class="s3">else</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s5">0</span><span class="s1">)</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">seq = line[:-</span><span class="s5">1</span><span class="s1">]</span>
                <span class="s1">protein_seq_dict[protein_index] = seq</span>
                <span class="s1">protein_index = protein_index + </span><span class="s5">1</span>
    <span class="s1">bpf=[]</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">protein_seq_dict:  </span><span class="s0"># and protein_fea_dict.has_key(protein) and RNA_fea_dict.has_key(RNA):</span>
        <span class="s1">bpf_feature = BPF(protein_seq_dict[i])</span>
        <span class="s1">bpf.append(bpf_feature)</span>
    <span class="s3">return </span><span class="s1">np.array(bpf)</span><span class="s3">, </span><span class="s1">label</span>

<span class="s3">def </span><span class="s1">prepare_feature_acp240():</span>
    <span class="s1">label = []</span>
    <span class="s1">protein_seq_dict = {}</span>
    <span class="s1">protein_index = </span><span class="s5">1</span>
    <span class="s3">with </span><span class="s1">open(</span><span class="s4">'acp240.txt'</span><span class="s3">, </span><span class="s4">'r'</span><span class="s1">) </span><span class="s3">as </span><span class="s1">fp:</span>
        <span class="s3">for </span><span class="s1">line </span><span class="s3">in </span><span class="s1">fp:</span>
            <span class="s3">if </span><span class="s1">line[</span><span class="s5">0</span><span class="s1">] == </span><span class="s4">'&gt;'</span><span class="s1">:</span>
                <span class="s1">values = line[</span><span class="s5">1</span><span class="s1">:].strip().split(</span><span class="s4">'|'</span><span class="s1">)</span>
                <span class="s1">label_temp = values[</span><span class="s5">1</span><span class="s1">]</span>
<span class="s0">#                protein = values[0]</span>
                <span class="s3">if </span><span class="s1">label_temp==</span><span class="s4">'1'</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s5">1</span><span class="s1">)</span>
                <span class="s3">else</span><span class="s1">:</span>
                    <span class="s1">label.append(</span><span class="s5">0</span><span class="s1">)</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">seq = line[:-</span><span class="s5">1</span><span class="s1">]</span>
                <span class="s1">protein_seq_dict[protein_index] = seq</span>
                <span class="s1">protein_index = protein_index + </span><span class="s5">1</span>
    <span class="s1">bpf = []</span>
    <span class="s0"># get protein feature</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">protein_seq_dict:  </span><span class="s0"># and protein_fea_dict.has_key(protein) and RNA_fea_dict.has_key(RNA):</span>

        <span class="s1">bpf_feature = BPF(protein_seq_dict[i])</span>
        <span class="s1">bpf.append(bpf_feature)</span>
        <span class="s1">protein_index = protein_index + </span><span class="s5">1</span>

    <span class="s3">return </span><span class="s1">np.array(bpf)</span><span class="s3">, </span><span class="s1">label</span>

<span class="s3">def </span><span class="s1">BPF(seq_temp):</span>
    <span class="s1">seq = seq_temp</span>
<span class="s0">#    chars = ['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y']</span>
    <span class="s1">fea = []</span>
    <span class="s1">tem_vec =[]</span>
    <span class="s1">k = </span><span class="s5">10</span>
    <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">range(k):</span>
        <span class="s3">if </span><span class="s1">seq[i] ==</span><span class="s4">'A'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'C'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'D'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'E'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'F'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'G'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'H'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'I'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'K'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'L'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'M'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'N'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'P'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'Q'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'R'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'S'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'T'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'V'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'W'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s3">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">elif </span><span class="s1">seq[i]==</span><span class="s4">'Y'</span><span class="s1">:</span>
            <span class="s1">tem_vec = [</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">0</span><span class="s3">,</span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">fea = fea + tem_vec</span>
    <span class="s3">return </span><span class="s1">fea</span>


<span class="s3">def </span><span class="s1">calculate_performace(test_num</span><span class="s3">, </span><span class="s1">pred_y</span><span class="s3">, </span><span class="s1">labels):</span>
    <span class="s1">tp = </span><span class="s5">0</span>
    <span class="s1">fp = </span><span class="s5">0</span>
    <span class="s1">tn = </span><span class="s5">0</span>
    <span class="s1">fn = </span><span class="s5">0</span>
    <span class="s3">for </span><span class="s1">index </span><span class="s3">in </span><span class="s1">range(test_num):</span>
        <span class="s3">if </span><span class="s1">labels[index] == </span><span class="s5">1</span><span class="s1">:</span>
            <span class="s3">if </span><span class="s1">labels[index] == pred_y[index]:</span>
                <span class="s1">tp = tp + </span><span class="s5">1</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">fn = fn + </span><span class="s5">1</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s3">if </span><span class="s1">labels[index] == pred_y[index]:</span>
                <span class="s1">tn = tn + </span><span class="s5">1</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">fp = fp + </span><span class="s5">1</span>

    <span class="s1">acc = float(tp + tn) / test_num</span>
    <span class="s1">precision = float(tp) / (tp + fp)</span>
    <span class="s1">sensitivity = float(tp) / (tp + fn)</span>
    <span class="s1">specificity = float(tn) / (tn + fp)</span>
    <span class="s1">MCC = float(tp * tn - fp * fn) / (np.sqrt((tp + fp) * (tp + fn) * (tn + fp) * (tn + fn)))</span>
    <span class="s3">return </span><span class="s1">acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC</span>

<span class="s3">def </span><span class="s1">ACP_DL():</span>
    <span class="s0"># define parameters</span>
    <span class="s1">num_cross_val = </span><span class="s5">5  </span><span class="s0"># 5-fold</span>
    <span class="s1">all_performance_lstm = []</span>
<span class="s0">#    all_labels = []</span>
    <span class="s1">all_prob = {}</span>
    <span class="s1">all_prob[</span><span class="s5">0</span><span class="s1">] = []</span>

    <span class="s3">for </span><span class="s1">fold </span><span class="s3">in </span><span class="s1">range(num_cross_val):</span>
        <span class="s1">train = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(X) </span><span class="s3">if </span><span class="s1">i % num_cross_val != fold])</span>
        <span class="s1">test = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(X) </span><span class="s3">if </span><span class="s1">i % num_cross_val == fold])</span>
        <span class="s1">train_label = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(label) </span><span class="s3">if </span><span class="s1">i % num_cross_val != fold])</span>
        <span class="s1">test_label = np.array([x </span><span class="s3">for </span><span class="s1">i</span><span class="s3">, </span><span class="s1">x </span><span class="s3">in </span><span class="s1">enumerate(label) </span><span class="s3">if </span><span class="s1">i % num_cross_val == fold])</span>
        <span class="s1">real_labels = []</span>
        <span class="s3">for </span><span class="s1">val </span><span class="s3">in </span><span class="s1">test_label:</span>
            <span class="s3">if </span><span class="s1">val == </span><span class="s5">1</span><span class="s1">:</span>
                <span class="s1">real_labels.append(</span><span class="s5">1</span><span class="s1">)</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">real_labels.append(</span><span class="s5">0</span><span class="s1">)</span>

        
<span class="s0">#Bagging with Random Forest </span>

<span class="s0">#        clf = BaggingClassifier(base_estimator=RandomForestClassifier(random_state=121,n_estimators=290),n_estimators=100,random_state=0, bootstrap=True)</span>


        <span class="s0"># ACP740  # ACP240</span>


<span class="s0">#        clf = MLPClassifier(hidden_layer_sizes=(100,100,100,100,100,100),alpha = 0.01, random_state=0)</span>
<span class="s0">#        clf = RandomForestClassifier(random_state=120,n_estimators=190)</span>
<span class="s0">#        clf = ExtraTreesClassifier(random_state=120,n_estimators=190)</span>
<span class="s0">#        clf = DecisionTreeClassifier(random_state=0)</span>
<span class="s0">#        clf = svm.SVC(kernel="linear")</span>
<span class="s0">#        clf = clf = KNeighborsClassifier(n_neighbors =9)</span>

<span class="s0">#Grid Search cv</span>

<span class="s0">#Boosting Algorithm for Classifiecation</span>
<span class="s0">#        clf = GradientBoostingClassifier(random_state=121,n_estimators=3000,learning_rate=0.1,loss='deviance')</span>
        <span class="s1">model = clf.fit(train</span><span class="s3">, </span><span class="s1">train_label)</span>
        
        <span class="s1">y_pred_xgb = model.predict(test)</span>



        <span class="s1">acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC = calculate_performace(len(real_labels)</span><span class="s3">, </span><span class="s1">y_pred_xgb</span><span class="s3">, </span><span class="s1">real_labels)</span>
        <span class="s1">print(acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC)</span>
        <span class="s1">all_performance_lstm.append([acc</span><span class="s3">, </span><span class="s1">precision</span><span class="s3">, </span><span class="s1">sensitivity</span><span class="s3">, </span><span class="s1">specificity</span><span class="s3">, </span><span class="s1">MCC])</span>


    <span class="s1">print(</span><span class="s4">'mean performance of ACP_DL'</span><span class="s1">)</span>
    <span class="s1">print(np.mean(np.array(all_performance_lstm)</span><span class="s3">, </span><span class="s1">axis=</span><span class="s5">0</span><span class="s1">))</span>

<span class="s0">#Confusion Matrix Plot</span>
    <span class="s1">ConfusionMatrixDisplay.from_predictions(test_label</span><span class="s3">,</span><span class="s1">y_pred_xgb)</span>
    <span class="s1">plt.show    </span>


<span class="s1">dataset = </span><span class="s5">1</span><span class="s0">#1.acp740   2.acp240</span>
<span class="s1">peptidelen = </span><span class="s5">40</span><span class="s0">#50  #60</span>

<span class="s3">if </span><span class="s1">dataset == </span><span class="s5">1</span><span class="s1">:</span>
<span class="s0">#    delta = 0.02  #acp740</span>
<span class="s0">#    augtimes = 2</span>
    <span class="s1">bpf</span><span class="s3">, </span><span class="s1">label = prepare_feature_acp740()</span>
    <span class="s1">X_aac</span><span class="s3">, </span><span class="s1">label = AAC_740()</span>
    <span class="s3">if </span><span class="s1">peptidelen == </span><span class="s5">40</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s4">'data740_40_50.pkl'</span><span class="s3">, </span><span class="s4">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s5">50</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s4">'data740_50_50.pkl'</span><span class="s3">, </span><span class="s4">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s5">60</span><span class="s1">:      </span>
        <span class="s1">data = pickle.load(open(</span><span class="s4">'data740_60_50.pkl'</span><span class="s3">, </span><span class="s4">'rb'</span><span class="s1">))</span>
<span class="s3">else</span><span class="s1">:</span>
<span class="s0">#    delta = 0.005  #acp240</span>
<span class="s0">#    augtimes = 1</span>
    <span class="s1">bpf</span><span class="s3">, </span><span class="s1">label = prepare_feature_acp240()</span>
    <span class="s1">X_aac</span><span class="s3">, </span><span class="s1">label = AAC_240()</span>
    <span class="s3">if </span><span class="s1">peptidelen == </span><span class="s5">40</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s4">'data240_40_50.pkl'</span><span class="s3">, </span><span class="s4">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s5">50</span><span class="s1">:</span>
        <span class="s1">data = pickle.load(open(</span><span class="s4">'data240_50_50.pkl'</span><span class="s3">, </span><span class="s4">'rb'</span><span class="s1">))</span>
    <span class="s3">elif </span><span class="s1">peptidelen == </span><span class="s5">60</span><span class="s1">:      </span>
        <span class="s1">data = pickle.load(open(</span><span class="s4">'data240_60_50.pkl'</span><span class="s3">, </span><span class="s4">'rb'</span><span class="s1">))    </span>

<span class="s1">X_aa = data[</span><span class="s4">'X'</span><span class="s1">]</span>
<span class="s1">X_aa = np.array(X_aa)</span>
<span class="s1">X = np.concatenate((bpf</span><span class="s3">, </span><span class="s1">X_aa</span><span class="s3">,</span><span class="s1">X_aac)</span><span class="s3">, </span><span class="s1">axis=</span><span class="s5">1</span><span class="s1">)     </span>

<span class="s1">ACP_DL()</span>

<span class="s1">X</span></pre>

</body></html>